<?xml version="1.0" encoding="UTF-8"?>
<!--
This Work is in the public domain and is provided on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied,
including, without limitation, any warranties or conditions of TITLE,
NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE.
You are solely responsible for determining the appropriateness of using
this Work and assume any risks associated with your use of this Work.

This Work includes contributions authored by David E. Jones, not as a
"work for hire", who hereby disclaims any copyright to the same.

This Work includes contributions authored by contributors to Apache OFBiz
and those parts may be licensed under the Apache License 2.0.
-->
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-1.3.xsd">
    <!-- ========================================================= -->
    <!--  - mantle.account.billing -->
    <!--  - mantle.account.financial -->
    <!--  - mantle.account.invoice -->
    <!--  - mantle.account.method -->
    <!--  - mantle.account.payment -->
    <!-- ========================================================= -->

    <!-- ========================================================= -->
    <!-- mantle.account.billing -->
    <!-- ========================================================= -->

    <entity entity-name="BillingAccount" package-name="mantle.account.billing">
        <field name="billingAccountId" type="id" is-pk="true"/>
        <field name="billToPartyId" type="id"/>
        <field name="billFromPartyId" type="id"/>
        <field name="accountLimit" type="currency-amount"/>
        <field name="accountLimitUomId" type="id"/>
        <field name="postalContactMechId" type="id"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="description" type="text-medium"/>
        <field name="externalAccountId" type="id"/>
        <relationship type="one" title="BillTo" related-entity-name="Party">
            <key-map field-name="billToPartyId"/>
        </relationship>
        <relationship type="one" title="AccountLimit" related-entity-name="moqui.basic.Uom">
            <key-map field-name="accountLimitUomId"/>
        </relationship>
        <relationship type="one" title="Postal" related-entity-name="ContactMech">
            <key-map field-name="postalContactMechId"/>
        </relationship>
        <relationship type="one" related-entity-name="PostalAddress">
            <key-map field-name="postalContactMechId"/>
        </relationship>
    </entity>
    <entity entity-name="BillingAccountParty" package-name="mantle.account.billing">
        <field name="billingAccountId" type="id" is-pk="true"/>
        <field name="partyId" type="id" is-pk="true"/>
        <field name="roleTypeId" type="id" is-pk="true"/>
        <field name="fromDate" type="date-time" is-pk="true"/>
        <field name="thruDate" type="date-time"/>
        <relationship type="one" related-entity-name="BillingAccount"/>
        <relationship type="one" related-entity-name="Party"/>
        <relationship type="one" related-entity-name="RoleType"/>
    </entity>
    <entity entity-name="BillingAccountTerm" package-name="mantle.account.billing">
        <field name="billingAccountTermId" type="id" is-pk="true"/>
        <field name="billingAccountId" type="id"/>
        <field name="termTypeEnumId" type="id"/>
        <field name="termValue" type="number-decimal"/>
        <field name="termUomId" type="id"/>
        <relationship type="one" title="BillingAccountTermType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="termTypeEnumId"/>
        </relationship>
        <relationship type="one" title="Term" related-entity-name="moqui.basic.Uom">
            <key-map field-name="termUomId"/>
        </relationship>
        <relationship type="one" related-entity-name="BillingAccount"/>
        <seed-data>
            <!-- Billing Account Term Type -->
            <moqui.basic.EnumerationType description="Billing Account Term Type" enumTypeId="BillingAccountTermType"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.financial -->
    <!-- ========================================================= -->

    <entity entity-name="FinancialAccount" package-name="mantle.account.financial">
        <field name="finAccountId" type="id" is-pk="true"/>
        <field name="finAccountTypeId" type="id"/>
        <field name="statusId" type="id" enable-audit-log="true"/>
        <field name="finAccountName" type="text-medium"/>
        <field name="finAccountCode" type="text-medium" encrypt="true"/>
        <field name="finAccountPin" type="text-medium" encrypt="true"/>
        <field name="organizationPartyId" type="id"><description>The internal organization Party that is liable for the
            account.</description></field>
        <field name="ownerPartyId" type="id"/>
        <field name="postToGlAccountId" type="id"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="isRefundable" type="text-indicator"/>
        <field name="balanceUomId" type="id"/>
        <field name="actualBalance" type="currency-amount"><description>Calculated as the sum of
            FinancialAccountTrans.amount</description></field>
        <field name="availableBalance" type="currency-amount"><description>Calculated as actualBalance minus sum of
            outstanding FinancialAccountAuth.amount</description></field>
        <field name="replenishPaymentId" type="id"/>
        <field name="replenishLevel" type="currency-amount"/>
        <relationship type="one" related-entity-name="FinancialAccountType">
            <key-map field-name="finAccountTypeId"/>
        </relationship>
        <relationship type="one" title="FinancialAccount" related-entity-name="moqui.basic.StatusItem"/>
        <relationship type="one" title="Organization" related-entity-name="Party">
            <key-map field-name="organizationPartyId"/>
        </relationship>
        <relationship type="one" title="Owner" related-entity-name="Party">
            <key-map field-name="ownerPartyId"/>
        </relationship>
        <relationship type="one" title="PostTo" related-entity-name="GlAccount">
            <key-map field-name="postToGlAccountId"/>
        </relationship>
        <relationship type="one" title="Balance" related-entity-name="moqui.basic.Uom">
            <key-map field-name="balanceUomId"/>
        </relationship>
        <relationship type="one" title="Replenish" related-entity-name="PaymentMethod">
            <key-map field-name="replenishPaymentId"/>
        </relationship>
        <seed-data>
            <!-- Financial Account Status -->
            <moqui.basic.StatusType description="Financial Account Status" statusTypeId="FinancialAccount"/>
            <moqui.basic.StatusItem description="Active" sequenceNum="1" statusId="FNACT_ACTIVE" statusTypeId="FinancialAccount"/>
            <!-- This is set automatically by the auto-replenishment code to allow one transaction to bring the balance below
                zero and then if any other transactions are attempted during replenishment they will be rejected. -->
            <moqui.basic.StatusItem description="Negative Pending Replenishment" sequenceNum="2" statusId="FNACT_NEGPENDREPL" statusTypeId="FinancialAccount"/>
            <!-- This is meant to be set manually by a company representative to freeze an account so further transactions are
                not allowed. -->
            <moqui.basic.StatusItem description="Manually Frozen" sequenceNum="3" statusId="FNACT_MANFROZEN" statusTypeId="FinancialAccount"/>
            <moqui.basic.StatusItem description="Cancelled" sequenceNum="9" statusId="FNACT_CANCELLED" statusTypeId="FinancialAccount"/>
            <moqui.basic.StatusValidChange statusId="FNACT_ACTIVE" toStatusId="FNACT_NEGPENDREPL" transitionName="Set Negative Pending Replenishment"/>
            <moqui.basic.StatusValidChange statusId="FNACT_ACTIVE" toStatusId="FNACT_MANFROZEN" transitionName="Set Manually Frozen"/>
            <moqui.basic.StatusValidChange statusId="FNACT_ACTIVE" toStatusId="FNACT_CANCELLED" transitionName="Cancel"/>
            <moqui.basic.StatusValidChange statusId="FNACT_NEGPENDREPL" toStatusId="FNACT_ACTIVE" transitionName="Re-activate"/>
            <moqui.basic.StatusValidChange statusId="FNACT_NEGPENDREPL" toStatusId="FNACT_MANFROZEN" transitionName="Manually Freeze"/>
            <moqui.basic.StatusValidChange statusId="FNACT_NEGPENDREPL" toStatusId="FNACT_CANCELLED" transitionName="Cancel"/>
            <moqui.basic.StatusValidChange statusId="FNACT_MANFROZEN" toStatusId="FNACT_ACTIVE" transitionName="Re-activate"/>
            <moqui.basic.StatusValidChange statusId="FNACT_MANFROZEN" toStatusId="FNACT_CANCELLED" transitionName="Cancel"/>
        </seed-data>
    </entity>
    <entity entity-name="FinancialAccountAuth" package-name="mantle.account.financial">
        <field name="finAccountAuthId" type="id" is-pk="true"/>
        <field name="finAccountId" type="id"/>
        <field name="amount" type="currency-amount"/>
        <field name="amountUomId" type="id"/>
        <field name="authorizationDate" type="date-time"/>
        <field name="expireDate" type="date-time"/>
        <relationship type="one" related-entity-name="FinancialAccount"/>
        <relationship type="one" title="Amount" related-entity-name="moqui.basic.Uom">
            <key-map field-name="amountUomId"/>
        </relationship>
    </entity>
    <entity entity-name="FinancialAccountParty" package-name="mantle.account.financial">
        <field name="finAccountId" type="id" is-pk="true"/>
        <field name="partyId" type="id" is-pk="true"/>
        <field name="roleTypeId" type="id" is-pk="true"/>
        <field name="fromDate" type="date-time" is-pk="true"/>
        <field name="thruDate" type="date-time"/>
        <relationship type="one" related-entity-name="FinancialAccount"/>
        <relationship type="one" related-entity-name="Party"/>
        <relationship type="one" related-entity-name="RoleType"/>
    </entity>
    <entity entity-name="FinancialAccountTrans" package-name="mantle.account.financial">
        <field name="finAccountTransId" type="id" is-pk="true"/>
        <field name="finAccountTransTypeEnumId" type="id"/>
        <field name="finAccountId" type="id"/>
        <field name="statusId" type="id"/>
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>
        <field name="glReconciliationId" type="id"/>
        <field name="transactionDate" type="date-time"/>
        <field name="entryDate" type="date-time"/>
        <field name="amount" type="currency-amount"/>
        <field name="paymentId" type="id"/>
        <field name="orderId" type="id"/>
        <field name="orderItemSeqId" type="id"><description>To be used along with orderId to point to an OrderItem that
            represents the purchase of a product to add money to the account.</description></field>
        <field name="performedByPartyId" type="id"/>
        <field name="reasonEnumId" type="id"/>
        <field name="comments" type="text-medium"/>
        <relationship type="one" title="FinancialAccountTransType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="finAccountTransTypeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="mantle.account.financial.FinancialAccount"/>
        <relationship type="one" title="FinancialAccountTrans" related-entity-name="moqui.basic.StatusItem"/>
        <relationship type="one" title="From" related-entity-name="mantle.party.Party">
            <key-map field-name="fromPartyId"/>
        </relationship>
        <relationship type="one" title="To" related-entity-name="mantle.party.Party">
            <key-map field-name="toPartyId"/>
        </relationship>
        <relationship type="one" related-entity-name="Payment"/>
        <relationship type="one" related-entity-name="OrderItem">
            <key-map field-name="orderId"/>
            <key-map field-name="orderItemSeqId"/>
        </relationship>
        <relationship type="one" title="PerformedBy" related-entity-name="mantle.party.Party">
            <key-map field-name="performedByPartyId"/>
        </relationship>
        <relationship type="one" title="FinancialAccountTransReason" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="reasonEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="GlReconciliation"/>
        <seed-data>
            <!-- Financial Account Trans Type -->
            <moqui.basic.EnumerationType description="Financial Account Trans Type" enumTypeId="FinancialAccountTransType"/>
            <moqui.basic.Enumeration description="Deposit" enumId="FATT_DEPOSIT" enumTypeId="FinancialAccountTransType"/>
            <moqui.basic.Enumeration description="Withdraw" enumId="FATT_WITHDRAWAL" enumTypeId="FinancialAccountTransType"/>
            <moqui.basic.Enumeration description="Adjustment" enumId="FATT_ADJUSTMENT" enumTypeId="FinancialAccountTransType"/>

            <!-- Financial Account Trans Status -->
            <moqui.basic.StatusType statusTypeId="FinancialAccountTrans" description="Financial Account Trans Status"/>
            <moqui.basic.StatusItem statusId="FINACT_TRNS_APPROVED" statusTypeId="FinancialAccountTrans" sequenceNum="1" description="Approved"/>
            <moqui.basic.StatusItem statusId="FINACT_TRNS_CREATED" statusTypeId="FinancialAccountTrans" sequenceNum="2" description="Created"/>
            <moqui.basic.StatusItem statusId="FINACT_TRNS_CANCELLD" statusTypeId="FinancialAccountTrans" sequenceNum="9" description="Cancelled"/>
            <moqui.basic.StatusValidChange statusId="FINACT_TRNS_CREATED" toStatusId="FINACT_TRNS_APPROVED" transitionName="Approve"/>
            <moqui.basic.StatusValidChange statusId="FINACT_TRNS_CREATED" toStatusId="FINACT_TRNS_CANCELLD" transitionName="Cancel"/>
            <moqui.basic.StatusValidChange statusId="FINACT_TRNS_APPROVED" toStatusId="FINACT_TRNS_CANCELLD" transitionName="Cancel"/>

            <!-- Financial Account Trans Reason -->
            <moqui.basic.EnumerationType description="Financial Account Trans Reason" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Purchase" enumId="FATR_PURCHASE" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Initial Deposit" enumId="FATR_IDEPOSIT" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Replenishment" enumId="FATR_REPLENISH" enumTypeId="FinancialAccountTransReason"/>
            <moqui.basic.Enumeration description="Refund" enumId="FATR_REFUND" enumTypeId="FinancialAccountTransReason"/>
        </seed-data>
    </entity>
    <entity entity-name="FinancialAccountType" package-name="mantle.account.financial">
        <field name="finAccountTypeId" type="id" is-pk="true"/>
        <field name="parentTypeId" type="id"/>
        <field name="description" type="text-medium"/>

        <field name="isRefundable" type="text-indicator"/>
        <field name="accountCodeLength" type="number-integer"/>
        <field name="requirePinCode" type="text-indicator"/>
        <field name="pinCodeLength" type="number-integer"/>
        <field name="accountValidDays" type="number-integer"/>
        <field name="authValidDays" type="number-integer"/>
        <field name="allowAuthToNegative" type="text-indicator"/>

        <field name="replenishMinBalance" type="currency-amount"/>
        <field name="replenishThreshold" type="currency-amount"/>
        <field name="replenishMethodEnumId" type="id"/>
        <field name="replenishTypeEnumId" type="id"/>

        <relationship type="one" title="Parent" related-entity-name="FinancialAccountType">
            <key-map field-name="parentTypeId" related-field-name="finAccountTypeId"/>
        </relationship>
        <relationship type="one" title="FinancialAccountReplenishMethod" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="replenishMethodEnumId"/>
        </relationship>
        <relationship type="one" title="FinancialAccountReplenishType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="replenishTypeEnumId"/>
        </relationship>
        <seed-data>
            <!-- Financial Account Replenish Type -->
            <moqui.basic.EnumerationType description="Financial Account Replenish Type" enumTypeId="FinancialAccountReplenishType"/>
            <moqui.basic.Enumeration description="Automatic Replenish" enumId="FARP_AUTOMATIC" enumTypeId="FinancialAccountReplenishType"/>
            <moqui.basic.Enumeration description="Manual Replenish" enumId="FARP_MANUAL" enumTypeId="FinancialAccountReplenishType"/>
            <moqui.basic.Enumeration description="No Replenish" enumId="FARP_NONE" enumTypeId="FinancialAccountReplenishType"/>

            <!-- Financial Account Replenish Method -->
            <moqui.basic.EnumerationType description="Financial Account Replenish Method" enumTypeId="FinancialAccountReplenishMethod"/>
            <moqui.basic.Enumeration description="Top-off" enumId="FARP_TOP_OFF" enumTypeId="FinancialAccountReplenishMethod"/>
            <moqui.basic.Enumeration description="Replenish-level" enumId="FARP_REPLENISH_LEVEL" enumTypeId="FinancialAccountReplenishMethod"/>

            <!-- Financial Account Type (NOTE: not an Enumeration because has additional fields) -->
            <FinancialAccountType description="Gift Certificate" finAccountTypeId="GIFTCERT_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="N"/>
            <FinancialAccountType description="Deposit Account" finAccountTypeId="DEPOSIT_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="Y"/>
            <FinancialAccountType description="Bank Account" finAccountTypeId="BANK_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="Y" parentTypeId="DEPOSIT_ACCOUNT"/>
            <FinancialAccountType description="Store Credit Account" finAccountTypeId="STORE_CREDIT_ACCT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="Y" parentTypeId="DEPOSIT_ACCOUNT"/>
            <FinancialAccountType description="Investment Account" finAccountTypeId="INVESTMENT_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="Y" parentTypeId="DEPOSIT_ACCOUNT"/>
            <FinancialAccountType description="Replenish Account" finAccountTypeId="REPLENISH_ACCOUNT"
                                  replenishTypeEnumId="FARP_AUTOMATIC" isRefundable="Y" parentTypeId="DEPOSIT_ACCOUNT"/>
            <FinancialAccountType description="Service Credit Account" finAccountTypeId="SVCCRED_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="N"/>
            <FinancialAccountType description="Loan Account" finAccountTypeId="LOAN_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="Y"/>
            <FinancialAccountType description="Credit Card Account" finAccountTypeId="CREDIT_CARD_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="Y" parentTypeId="LOAN_ACCOUNT"/>
            <FinancialAccountType description="Equity Line Account" finAccountTypeId="EQUITY_LINE_ACCOUNT"
                                  replenishTypeEnumId="FARP_MANUAL" isRefundable="Y" parentTypeId="LOAN_ACCOUNT"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.invoice -->
    <!-- ========================================================= -->

    <entity entity-name="Invoice" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="invoiceTypeEnumId" type="id"/>
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>
        <field name="statusId" type="id" enable-audit-log="true"/>
        <field name="billingAccountId" type="id"/>
        <field name="invoiceDate" type="date-time"/>
        <field name="dueDate" type="date-time"/>
        <field name="paidDate" type="date-time"/>
        <field name="invoiceMessage" type="text-long"/>
        <field name="referenceNumber" type="text-medium"><description>Vendor or other invoice number.</description></field>
        <field name="description" type="text-medium"/>
        <field name="currencyUomId" type="id"/>
        <relationship type="one" title="InvoiceType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="invoiceTypeEnumId"/>
        </relationship>
        <relationship type="one" title="From" related-entity-name="Party">
            <key-map field-name="fromPartyId"/>
        </relationship>
        <relationship type="one" title="To" related-entity-name="Party">
            <key-map field-name="toPartyId"/>
        </relationship>
        <relationship type="one" title="Invoice" related-entity-name="moqui.basic.StatusItem"/>
        <relationship type="one" related-entity-name="BillingAccount"/>
        <relationship type="one" title="Currency" related-entity-name="moqui.basic.Uom">
            <key-map field-name="currencyUomId"/>
        </relationship>
        <seed-data>
            <!-- Invoice Type -->
            <moqui.basic.EnumerationType description="Invoice Type" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Sales" enumId="INVOICE_SALES" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Return" enumId="INVOICE_RETURN" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Payroll" enumId="INVOICE_PAYROLL" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Commission" enumId="INVOICE_COMMISSION" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Template" enumId="INVOICE_TEMPLATE" enumTypeId="InvoiceType"/>
            <!-- the old approach, not from/to Party sensitive:
            <moqui.basic.Enumeration description="Payable Invoice" enumId="IT_PAYABLE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Purchase Invoice" enumId="PURCHASE_INVOICE" parentEnumId="IT_PAYABLE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Customer Return" enumId="CUST_RTN_INVOICE" parentEnumId="IT_PAYABLE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Commission" enumId="COMMISSION_INVOICE" parentEnumId="IT_PAYABLE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Payroll" enumId="PAYROLL_INVOICE" parentEnumId="IT_PAYABLE" enumTypeId="InvoiceType"/>

            <moqui.basic.Enumeration description="Receivable Invoice" enumId="IT_RECEIVABLE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Sales Invoice" enumId="SALES_INVOICE" parentEnumId="IT_RECEIVABLE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Vendor Return" enumId="VEND_RTN_INVOICE" parentEnumId="IT_RECEIVABLE" enumTypeId="InvoiceType"/>

            <moqui.basic.Enumeration description="Invoice Template" enumId="TEMPLATE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Sales Invoice Template" enumId="SALES_INV_TEMPLATE" parentEnumId="TEMPLATE" enumTypeId="InvoiceType"/>
            <moqui.basic.Enumeration description="Purchase Invoice Template" enumId="PUR_INV_TEMPLATE" parentEnumId="TEMPLATE" enumTypeId="InvoiceType"/>
            -->

            <!-- Invoice Status -->
            <moqui.basic.StatusType description="Invoice Status" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="In-Process" sequenceNum="1" statusId="INVOICE_IN_PROCESS" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Approved" sequenceNum="2" statusId="INVOICE_APPROVED" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Sent" sequenceNum="10" statusId="INVOICE_SENT" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Received" sequenceNum="11" statusId="INVOICE_RECEIVED" statusTypeId="Invoice"/>
            <!-- READY is a very important state - it triggers general ledger postings.  Make sure your invoices go through this state -->
            <moqui.basic.StatusItem description="Ready for Posting" sequenceNum="20" statusId="INVOICE_READY" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Paid" sequenceNum="30" statusId="INVOICE_PAID" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Write Off" sequenceNum="31" statusId="INVOICE_WRITEOFF" statusTypeId="Invoice"/>
            <moqui.basic.StatusItem description="Cancelled" sequenceNum="99" statusId="INVOICE_CANCELLED" statusTypeId="Invoice"/>
            <!-- this is the simplest process: IN_PROCESS -> READY or CANCELLED -->
            <moqui.basic.StatusValidChange statusId="INVOICE_IN_PROCESS" toStatusId="INVOICE_READY" transitionName="Mark Ready"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_IN_PROCESS" toStatusId="INVOICE_CANCELLED" transitionName="Cancel"/>
            <!-- this is a more complicated process: IN_PROCESS -> SENT -> (optionally RECEIVED) -> READY or CANCELLED -->
            <moqui.basic.StatusValidChange statusId="INVOICE_IN_PROCESS" toStatusId="INVOICE_SENT" transitionName="Send"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_IN_PROCESS" toStatusId="INVOICE_RECEIVED" transitionName="Receive"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_SENT" toStatusId="INVOICE_APPROVED" transitionName="Mark Approved"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_SENT" toStatusId="INVOICE_READY" transitionName="Mark Ready"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_SENT" toStatusId="INVOICE_RECEIVED" transitionName="Receive"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_RECEIVED" toStatusId="INVOICE_READY" transitionName="Mark Receive"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_SENT" toStatusId="INVOICE_CANCELLED" transitionName="Cancel"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_RECEIVED" toStatusId="INVOICE_CANCELLED" transitionName="Cancel"/>
            <!-- this is a process to enable modification via the Status IN_PROCESS when the receiver/sender wants an invoice change or to cancel it -->
            <moqui.basic.StatusValidChange statusId="INVOICE_SENT" toStatusId="INVOICE_IN_PROCESS" transitionName="Enable sales invoice update"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_RECEIVED" toStatusId="INVOICE_IN_PROCESS" transitionName="Enable purch.invoice update"/>
            <!-- an optional approval state is put in before invoice is sent or after it is received -->
            <moqui.basic.StatusValidChange statusId="INVOICE_IN_PROCESS" toStatusId="INVOICE_APPROVED" transitionName="Approve"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_APPROVED" toStatusId="INVOICE_SENT" transitionName="Send"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_IN_PROCESS" toStatusId="INVOICE_RECEIVED" transitionName="Receive"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_RECEIVED" toStatusId="INVOICE_APPROVED" transitionName="Approve"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_APPROVED" toStatusId="INVOICE_READY" transitionName="Mark Ready"/>
            <!-- finally the invoice can be paid or written off.   -->
            <moqui.basic.StatusValidChange statusId="INVOICE_READY" toStatusId="INVOICE_PAID" transitionName="Pay"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_READY" toStatusId="INVOICE_WRITEOFF" transitionName="Write Off"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_PAID" toStatusId="INVOICE_READY" transitionName="Unpay"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_READY" toStatusId="INVOICE_CANCELLED" transitionName="Cancel"/>
            <moqui.basic.StatusValidChange statusId="INVOICE_PAID" toStatusId="INVOICE_CANCELLED" transitionName="Cancel"/>
        </seed-data>
    </entity>
    <entity entity-name="InvoiceContactMech" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="contactMechPurposeEnumId" type="id" is-pk="true"/>
        <field name="contactMechId" type="id" is-pk="true"/>
        <relationship type="one" related-entity-name="Invoice"/>
        <relationship type="one" title="ContactMechPurpose" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="contactMechPurposeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="ContactMech"/>
    </entity>
    <entity entity-name="InvoiceItem" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="invoiceItemSeqId" type="id" is-pk="true"/>
        <field name="itemTypeEnumId" type="id"/>
        <field name="overrideGlAccountId" type="id"><description>used to specify the override or actual glAccountId
            used for the invoice, avoids problems if configuration changes after initial posting, etc</description></field>
        <field name="overrideOrgPartyId" type="id"><description>Used to specify the organization override rather than
            using the payToPartyId</description></field>
        <field name="assetId" type="id"/>
        <field name="productId" type="id"/>
        <field name="parentInvoiceId" type="id"/>
        <field name="parentInvoiceItemSeqId" type="id"/>
        <field name="uomId" type="id"/>
        <field name="taxableFlag" type="text-indicator"/>
        <field name="quantity" type="number-decimal"/>
        <field name="amount" type="currency-precise"/>
        <field name="description" type="text-medium"/>
        <field name="taxAuthPartyId" type="id"/>
        <field name="taxAuthGeoId" type="id"/>
        <field name="taxAuthorityRateId" type="id"/>
        <field name="salesOpportunityId" type="id"/>
        <relationship type="one" title="ItemType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="itemTypeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="Invoice"/>
        <relationship type="one" related-entity-name="Asset"/>
        <relationship type="one" related-entity-name="Product"/>
        <relationship type="one" title="Parent" related-entity-name="InvoiceItem">
            <key-map field-name="parentInvoiceId" related-field-name="invoiceId"/>
            <key-map field-name="parentInvoiceItemSeqId" related-field-name="invoiceItemSeqId"/>
        </relationship>
        <relationship type="one" related-entity-name="moqui.basic.Uom"/>
        <relationship type="one" title="Override" related-entity-name="GlAccount">
            <key-map field-name="overrideGlAccountId"/>
        </relationship>
        <relationship type="one" title="TaxAuthority" related-entity-name="Party">
            <key-map field-name="taxAuthPartyId"/>
        </relationship>
        <relationship type="one" title="Tax" related-entity-name="Geo">
            <key-map field-name="taxAuthGeoId"/>
        </relationship>
        <relationship type="one" related-entity-name="TaxAuthorityRate"/>
        <relationship type="one" title="OverrideOrg" related-entity-name="Party">
            <key-map field-name="overrideOrgPartyId"/>
        </relationship>
        <relationship type="one" related-entity-name="SalesOpportunity"/>
    </entity>
    <entity entity-name="InvoiceItemAssoc" package-name="mantle.account.invoice">
        <field name="invoiceItemAssocId" type="id" is-pk="true"/>
        <field name="invoiceId" type="id"/>
        <field name="invoiceItemSeqId" type="id"/>
        <field name="toInvoiceId" type="id"/>
        <field name="toInvoiceItemSeqId" type="id"/>
        <field name="invoiceItemAssocTypeEnumId" type="id"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>
        <field name="quantity" type="number-decimal"/>
        <field name="amount" type="currency-amount"/>
        <relationship type="one" title="InvoiceItemAssocType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="invoiceItemAssocTypeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="InvoiceItem">
            <key-map field-name="invoiceId"/>
            <key-map field-name="invoiceItemSeqId"/>
        </relationship>
        <relationship type="one" title="To" related-entity-name="InvoiceItem">
            <key-map field-name="toInvoiceId" related-field-name="invoiceId"/>
            <key-map field-name="toInvoiceItemSeqId" related-field-name="invoiceItemSeqId"/>
        </relationship>
        <relationship type="one" title="From" related-entity-name="Party">
            <key-map field-name="fromPartyId"/>
        </relationship>
        <relationship type="one" title="To" related-entity-name="Party">
            <key-map field-name="toPartyId"/>
        </relationship>
        <seed-data>
            <!-- Invoice Item Assoc Type -->
            <moqui.basic.EnumerationType description="Invoice Item Assoc Type" enumTypeId="InvoiceItemAssocType"/>
            <moqui.basic.Enumeration description="Commission" enumId="COMMISSION_INVOICE" enumTypeId="InvoiceItemAssocType"/>
            <moqui.basic.Enumeration description="Withdraw" enumId="WITHDRAW_INVOICE" enumTypeId="InvoiceItemAssocType"/>
        </seed-data>
    </entity>
    <entity entity-name="InvoiceParty" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="partyId" type="id" is-pk="true"/>
        <field name="roleTypeId" type="id" is-pk="true"/>
        <field name="datetimePerformed" type="date-time"/>
        <field name="percentage" type="number-decimal"/>
        <relationship type="one" related-entity-name="Invoice"/>
        <relationship type="one" related-entity-name="Party"/>
        <relationship type="one" related-entity-name="RoleType"/>
    </entity>
    <entity entity-name="InvoiceTerm" package-name="mantle.account.invoice">
        <field name="invoiceId" type="id" is-pk="true"/>
        <field name="invoiceItemSeqId" type="id" is-pk="true"/>
        <field name="settlementTermId" type="id" is-pk="true"/>
        <relationship type="one" related-entity-name="Invoice">
            <key-map field-name="invoiceId"/>
        </relationship>
        <relationship type="one-nofk" related-entity-name="InvoiceItem">
            <key-map field-name="invoiceId"/>
            <key-map field-name="invoiceItemSeqId"/>
        </relationship>
        <relationship type="one" related-entity-name="SettlementTerm"/>
    </entity>
    <entity entity-name="SettlementTerm" package-name="mantle.account.invoice">
        <field name="settlementTermId" type="id" is-pk="true"/>
        <field name="termTypeEnumId" type="id"/>
        <field name="description" type="text-medium"/>
        <field name="termValue" type="number-integer"/>
        <field name="termValueUomId" type="id"/>
        <relationship type="one" title="TermType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="termTypeEnumId"/>
        </relationship>
        <relationship type="one" title="TermValue" related-entity-name="moqui.basic.Uom">
            <key-map field-name="termValueUomId"/>
        </relationship>
        <seed-data>
            <!-- NOTE: this is not an Enumeration because it needs additional fields -->
            <SettlementTerm settlementTermId="IMMED" description="Immediate (Due on Delivery)" termValue="0" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="NET_15" description="Net Due in 15 Days" termValue="15" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="NET_30" description="Net Due in 30 Days" termValue="30" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="NET_60" description="Net Due in 60 Days" termValue="60" termValueUomId="TF_day"/>
            <SettlementTerm settlementTermId="NET_90" description="Net Due in 90 Days" termValue="90" termValueUomId="TF_day"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.method -->
    <!-- ========================================================= -->

    <entity entity-name="PaymentMethod" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="paymentMethodTypeEnumId" type="id"/>
        <field name="ownerPartyId" type="id"/>
        <field name="description" type="text-medium"/>
        <field name="fromDate" type="date-time"/>
        <field name="thruDate" type="date-time"/>
        <field name="postalContactMechId" type="id"/>
        <field name="telecomContactMechId" type="id"/>
        <field name="trustLevelEnumId" type="id"/>
        <field name="paymentFraudEvidenceId" type="id"><description>Refer to evidence here if trustLevelEnumId is gray
            listed or black listed.</description></field>
        <field name="glAccountId" type="id"/>
        <field name="finAccountId" type="id"/>
        <relationship type="one" title="PaymentMethodType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="paymentMethodTypeEnumId"/>
        </relationship>
        <relationship type="one" title="Owner" related-entity-name="mantle.party.Party">
            <key-map field-name="ownerPartyId"/>
        </relationship>
        <relationship type="one" title="Postal" related-entity-name="ContactMech">
            <key-map field-name="postalContactMechId"/>
        </relationship>
        <relationship type="one" related-entity-name="PostalAddress">
            <key-map field-name="postalContactMechId"/>
        </relationship>
        <relationship type="one" title="Telecom" related-entity-name="ContactMech">
            <key-map field-name="telecomContactMechId"/>
        </relationship>
        <relationship type="one" related-entity-name="TelecomNumber">
            <key-map field-name="telecomContactMechId"/>
        </relationship>
        <relationship type="one" title="ContactPaymentTrustLevel" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="trustLevelEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.PaymentFraudEvidence"/>
        <relationship type="one" related-entity-name="GlAccount"/>
        <relationship type="one" related-entity-name="FinancialAccount"/>
        <seed-data>
            <!-- Payment Method Type -->
            <moqui.basic.EnumerationType description="Payment Method Type" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Bitcoin Wallet" enumId="PMT_BITCOIN_WALLET" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Credit Card" enumId="PMT_CREDIT_CARD" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Gift Card" enumId="PMT_GIFT_CARD" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Gift Certificate" enumId="PMT_GIFT_CERTIFICATE" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Cash" enumId="PMT_CASH" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Electronic Funds Transfer" enumId="PMT_EFT_ACCOUNT" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Financial Account" enumId="PMT_FIN_ACCOUNT" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Personal Check" enumId="PMT_PERSONAL_CHECK" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Company Check" enumId="PMT_COMPANY_CHECK" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Certified Check" enumId="PMT_CERTIFIED_CHECK" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Money Order" enumId="PMT_MONEY_ORDER" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Company Account" enumId="PMT_COMPANY_ACCOUNT" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Billing Account" enumId="PMT_EXT_BILLACT" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Cash On Delivery" enumId="PMT_EXT_COD" enumTypeId="PaymentMethodType"/>
            <moqui.basic.Enumeration description="Offline Payment" enumId="PMT_EXT_OFFLINE" enumTypeId="PaymentMethodType"/>
        </seed-data>
    </entity>
    <entity entity-name="BitcoinWallet" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="walletAddress" type="text-medium"/>
        <field name="description" type="text-medium"/>
        <field name="onlineWalletUrl" type="text-medium"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
    </entity>
    <entity entity-name="CreditCard" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="creditCardTypeEnumId" type="id"/>
        <field name="cardNumber" type="text-medium" encrypt="true"/>
        <field name="cardNumberLookupHash" type="text-medium"><description>A one-way hash (SHA, etc) of the cardNumber
            used for looking up a credit card by its number in a secure way.</description></field>
        <field name="validFromDate" type="text-short"><description>Not common in some parts of the world.</description></field>
        <field name="expireDate" type="text-short"><description>String representing the date in the format: MM/yyyy</description></field>
        <field name="issueNumber" type="text-short"><description>Single digit number on some Switch and Maestro cards.</description></field>

        <field name="companyNameOnCard" type="text-medium"/>
        <field name="titleOnCard" type="text-medium"/>
        <field name="firstNameOnCard" type="text-medium"/>
        <field name="middleNameOnCard" type="text-medium"/>
        <field name="lastNameOnCard" type="text-medium"/>
        <field name="suffixOnCard" type="text-medium"/>

        <field name="consecutiveFailedAuths" type="number-integer"/>
        <field name="lastFailedAuthDate" type="date-time"/>
        <field name="consecutiveFailedNsf" type="number-integer"/>
        <field name="lastFailedNsfDate" type="date-time"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <relationship type="one" title="CreditCardType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="creditCardTypeEnumId"/>
        </relationship>
        <index name="CC_NUMBER_LOOKUP"><index-field name="cardNumberLookupHash"/></index>
        <seed-data>
            <!-- Credit Card Type -->
            <moqui.basic.EnumerationType description="Credit Card Type" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Visa" enumId="CCT_VISA" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Master Card" enumId="CCT_MASTERCARD" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="American Express" enumId="CCT_AMERICANEXPRESS" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Diners Club" enumId="CCT_DINERSCLUB" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Discover" enumId="CCT_DISCOVER" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="EnRoute" enumId="CCT_ENROUTE" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Carte Blanche" enumId="CCT_CARTEBLANCHE" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="JCB" enumId="CCT_JCB" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Solo" enumId="CCT_SOLO" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Switch" enumId="CCT_SWITCH" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Visa Electron" enumId="CCT_VISAELECTRON" enumTypeId="CreditCardType"/>
            <moqui.basic.Enumeration description="Universal Air Travel Plan" enumId="CCT_UATP" enumTypeId="CreditCardType"/>
        </seed-data>
    </entity>
    <entity entity-name="EftAccount" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="bankName" type="text-medium"/>
        <field name="routingNumber" type="text-short"/>
        <field name="accountType" type="text-short"/>
        <field name="accountNumber" type="text-medium"/>
        <field name="nameOnAccount" type="text-medium"/>
        <field name="companyNameOnAccount" type="text-medium"/>
        <field name="yearsAtBank" type="number-integer"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
    </entity>
    <entity entity-name="GiftCard" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="cardNumber" type="text-medium" encrypt="true"/>
        <field name="pinNumber" type="text-medium" encrypt="true"/>
        <field name="expireDate" type="text-short"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
    </entity>
    <entity entity-name="GiftCardFulfillment" package-name="mantle.account.method">
        <field name="fulfillmentId" type="id" is-pk="true"/>
        <field name="typeEnumId" type="id"/>
        <field name="merchantId" type="id-long"/>
        <field name="partyId" type="id"/>
        <field name="orderId" type="id"/>
        <field name="orderItemSeqId" type="id"/>
        <field name="surveyResponseId" type="id"><!-- TODO replace this with dyn form or something --></field>
        <field name="cardNumber" type="text-medium" encrypt="true"/>
        <field name="pinNumber" type="text-medium" encrypt="true"/>
        <field name="amount" type="currency-amount"/>
        <field name="responseCode" type="text-short"/>
        <field name="referenceNum" type="text-short"/>
        <field name="authCode" type="text-short"/>
        <field name="fulfillmentDate" type="date-time"/>
        <relationship type="one" title="GiftCardFulfillmentType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="typeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="mantle.party.Party">
            <key-map field-name="partyId"/>
        </relationship>
        <relationship type="one" related-entity-name="OrderHeader">
            <key-map field-name="orderId"/>
        </relationship>
        <relationship type="one" related-entity-name="OrderItem">
            <key-map field-name="orderId"/>
            <key-map field-name="orderItemSeqId"/>
        </relationship>
    </entity>
    <entity entity-name="PayPalAccount" package-name="mantle.account.method">
        <field name="paymentMethodId" type="id" is-pk="true"/>
        <field name="payerId" type="id"/>
        <field name="expressCheckoutToken" type="text-short"/>
        <field name="payerStatus" type="text-short"/>
        <field name="avsAddr" type="text-indicator"/>
        <field name="avsZip" type="text-indicator"/>
        <field name="correlationId" type="id"/>
        <field name="transactionId" type="text-short"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
    </entity>

    <entity entity-name="PaymentGatewayConfig" package-name="mantle.account.method">
        <field name="paymentGatewayConfigId" type="id" is-pk="true"/>
        <field name="paymentGatewayTypeEnumId" type="id"><description>Each payment gateway integration should define a
            PaymentGatewayType Enumeration record plus an entity with a shared PK (ie PK is paymentGatewayConfigId).</description></field>
        <field name="description" type="text-medium"/>
        <field name="authorizeServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.authorize#Payment interface.</description></field>
        <field name="captureServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.capture#Payment interface.</description></field>
        <field name="releaseServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.release#Payment interface.</description></field>
        <field name="refundServiceName" type="text-medium"><description>Service implementing
            mantle.account.PaymentServices.refund#Payment interface.</description></field>
        <relationship type="one" title="PaymentGatewayType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="paymentGatewayTypeEnumId"/>
        </relationship>
    </entity>
    <entity entity-name="PaymentGatewayResponse" package-name="mantle.account.method">
        <field name="paymentGatewayResponseId" type="id" is-pk="true"/>
        <field name="paymentGatewayConfigId" type="id"/>
        <field name="paymentOperationEnumId" type="id"/>
        <field name="paymentId" type="id"/>
        <field name="paymentMethodId" type="id"/>
        <field name="transCodeEnumId" type="id"/>
        <field name="amount" type="currency-amount"/>
        <field name="amountUomId" type="id"/>
        <field name="referenceNum" type="text-short"/>
        <field name="altReference" type="text-short"/>
        <field name="subReference" type="text-short"/>
        <field name="gatewayCode" type="text-short"/>
        <field name="gatewayFlag" type="text-short"/>
        <field name="gatewayAvsResult" type="text-short"/>
        <field name="gatewayCvResult" type="text-short"/>
        <field name="gatewayScoreResult" type="text-short"/>
        <field name="gatewayMessage" type="text-medium"/>
        <field name="transactionDate" type="date-time"/>
        <field name="resultDeclined" type="text-indicator"/>
        <field name="resultNsf" type="text-indicator"/>
        <field name="resultBadExpire" type="text-indicator"/>
        <field name="resultBadCardNumber" type="text-indicator"/>
        <relationship type="one" title="PaymentOperation" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="paymentOperationEnumId" related-field-name="enumId"/>
        </relationship>
        <relationship type="one" title="TransCode" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="transCodeEnumId" related-field-name="enumId"/>
        </relationship>
        <relationship type="one" title="Amount" related-entity-name="moqui.basic.Uom">
            <key-map field-name="amountUomId"/>
        </relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <seed-data>
            <moqui.basic.EnumerationType description="Payment Gateway Operation" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Authorize" enumId="PMTOP_AUTHORIZE" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Capture" enumId="PMTOP_CAPTURE" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Refund" enumId="PMTOP_REFUND" enumTypeId="PaymentOperation"/>
            <moqui.basic.Enumeration description="Release" enumId="PMTOP_RELEASE" enumTypeId="PaymentOperation"/>
        </seed-data>
    </entity>

    <!-- ========================================================= -->
    <!-- mantle.account.payment -->
    <!-- ========================================================= -->

    <entity entity-name="Deduction" package-name="mantle.account.payment">
        <field name="deductionId" type="id" is-pk="true"/>
        <field name="deductionTypeEnumId" type="id"/>
        <field name="paymentId" type="id"/>
        <field name="amount" type="currency-amount"/>
        <relationship type="one" title="DeductionType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="deductionTypeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="Payment"/>
    </entity>
    <entity entity-name="Payment" package-name="mantle.account.payment">
        <field name="paymentId" type="id" is-pk="true"/>
        <field name="paymentTypeEnumId" type="id"/>
        <field name="fromPartyId" type="id"/>
        <field name="toPartyId" type="id"/>

        <field name="paymentMethodTypeEnumId" type="id"/>
        <field name="paymentMethodId" type="id"/>
        <field name="orderId" type="id"><description>Set if the Payment represents the payment settings for an Order.</description></field>
        <field name="orderPartSeqId" type="id"><description>Set if the Payment represents the payment settings for an OrderPart.</description></field>

        <field name="statusId" type="id" enable-audit-log="true"/>
        <field name="effectiveDate" type="date-time"/>
        <field name="paymentAuthCode" type="text-short"/>
        <field name="paymentRefNum" type="text-short"/>

        <field name="amount" type="currency-amount"/>
        <field name="amountUomId" type="id"/>

        <field name="comments" type="text-medium"/>
        <field name="finAccountAuthId" type="id"/>
        <field name="finAccountTransId" type="id"/>
        <field name="overrideGlAccountId" type="id"/>

        <!-- The Original Currency amount and uomId are for the values coming from the bank (if known) and are to be used for reconciliation and such later, and not for PaymentApplication. -->
        <field name="originalCurrencyAmount" type="currency-amount"/>
        <field name="originalCurrencyUomId" type="id"/>

        <field name="presentFlag" type="text-indicator"/>
        <field name="swipedFlag" type="text-indicator"/>
        <field name="processAttempt" type="number-integer"/>
        <field name="needsNsfRetry" type="text-indicator"/>

        <relationship type="one" title="PaymentType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="paymentTypeEnumId"/>
        </relationship>
        <relationship type="one" title="PaymentMethodType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="paymentMethodTypeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="mantle.account.method.PaymentMethod"/>
        <relationship type="one" related-entity-name="OrderHeader"/>

        <relationship type="one" title="Amount" related-entity-name="moqui.basic.Uom">
            <key-map field-name="amountUomId"/>
        </relationship>
        <relationship type="one" title="OriginalCurrency" related-entity-name="moqui.basic.Uom">
            <key-map field-name="originalCurrencyUomId"/>
        </relationship>
        <relationship type="one" title="From" related-entity-name="Party"><key-map field-name="fromPartyId"/></relationship>
        <relationship type="one" title="To" related-entity-name="Party"><key-map field-name="toPartyId"/></relationship>
        <relationship type="one" related-entity-name="moqui.basic.StatusItem"/>
        <relationship type="one" related-entity-name="FinancialAccountAuth"/>
        <relationship type="one" related-entity-name="FinancialAccountTrans"/>
        <relationship type="one" title="Override" related-entity-name="GlAccount">
            <key-map field-name="overrideGlAccountId"/>
        </relationship>
        <seed-data>
            <!-- Payment Type -->
            <moqui.basic.EnumerationType description="Payment Type" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Disbursement" enumId="PAYMENT_DISBURSE" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Refund" enumId="PAYMENT_REFUND" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Invoice Payment" enumId="PAYMENT_INVOICE" enumTypeId="PaymentType"/>
            <!-- OLD payment types, not party or invoice type sensitive:
            <moqui.basic.Enumeration description="Disbursement" enumId="DISBURSEMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Customer Refund" parentEnumId="DISBURSEMENT" enumId="CUSTOMER_REFUND" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Vendor Payment" parentEnumId="DISBURSEMENT" enumId="VENDOR_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Vendor Prepayment" parentEnumId="DISBURSEMENT" enumId="VENDOR_PREPAY" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Commission Payment" parentEnumId="DISBURSEMENT" enumId="COMMISSION_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Payroll Payment" parentEnumId="DISBURSEMENT" enumId="PAYROLL_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Pay Check" parentEnumId="DISBURSEMENT" enumId="PAY_CHECK" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Tax Payment" parentEnumId="DISBURSEMENT" enumId="TAX_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Sales Tax Payment" parentEnumId="TAX_PAYMENT" enumId="SALES_TAX_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Payroll Tax Payment" parentEnumId="TAX_PAYMENT" enumId="PAYROLL_TAX_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Income Tax Payment" parentEnumId="TAX_PAYMENT" enumId="INCOME_TAX_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Gift Certificate Withdrawal"  parentEnumId="DISBURSEMENT" enumId="GC_WITHDRAWAL" enumTypeId="PaymentType"/>

            <moqui.basic.Enumeration description="Receipt" enumId="RECEIPT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Customer Payment" parentEnumId="RECEIPT" enumId="CUSTOMER_PAYMENT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Customer Deposit" parentEnumId="RECEIPT" enumId="CUSTOMER_DEPOSIT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Interest Receipt" parentEnumId="RECEIPT" enumId="INTEREST_RECEIPT" enumTypeId="PaymentType"/>
            <moqui.basic.Enumeration description="Gift Certificate Deposit"  parentEnumId="RECEIPT" enumId="GC_DEPOSIT" enumTypeId="PaymentType"/>
            -->

            <!-- Payment Status -->
            <moqui.basic.StatusType description="Payment Status" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Proposed" sequenceNum="1" statusId="PMNT_PROPOSED" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Promised" sequenceNum="2" statusId="PMNT_PROMISED" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Authorized" sequenceNum="3" statusId="PMNT_AUTHORIZED" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Sent/Settled" sequenceNum="4" statusId="PMNT_SENT" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Received" sequenceNum="5" statusId="PMNT_RECEIVED" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Confirmed Paid" sequenceNum="6" statusId="PMNT_CONFIRMED" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Cancelled" sequenceNum="91" statusId="PMNT_CANCELLED" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Void" sequenceNum="92" statusId="PMNT_VOID" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Declined" sequenceNum="93" statusId="PMNT_DECLINED" statusTypeId="Payment"/>
            <moqui.basic.StatusItem description="Refunded" sequenceNum="94" statusId="PMNT_REFUNDED" statusTypeId="Payment"/>

            <moqui.basic.StatusValidChange statusId="PMNT_PROPOSED" toStatusId="PMNT_PROMISED" transitionName="Promised"/>
            <moqui.basic.StatusValidChange statusId="PMNT_PROMISED" toStatusId="PMNT_AUTHORIZED" transitionName="Sent"/>
            <moqui.basic.StatusValidChange statusId="PMNT_PROMISED" toStatusId="PMNT_SENT" transitionName="Sent"/>
            <moqui.basic.StatusValidChange statusId="PMNT_PROMISED" toStatusId="PMNT_RECEIVED" transitionName="Received"/>
            <moqui.basic.StatusValidChange statusId="PMNT_PROMISED" toStatusId="PMNT_CANCELLED" transitionName="Cancelled"/>
            <moqui.basic.StatusValidChange statusId="PMNT_PROMISED" toStatusId="PMNT_DECLINED" transitionName="Sent"/>

            <moqui.basic.StatusValidChange statusId="PMNT_AUTHORIZED" toStatusId="PMNT_SENT" transitionName="Sent"/>
            <moqui.basic.StatusValidChange statusId="PMNT_AUTHORIZED" toStatusId="PMNT_VOID" transitionName="Voided"/>
            <moqui.basic.StatusValidChange statusId="PMNT_AUTHORIZED" toStatusId="PMNT_DECLINED" transitionName="Declined"/>

            <moqui.basic.StatusValidChange statusId="PMNT_SENT" toStatusId="PMNT_REFUNDED" transitionName="Refunded"/>
            <moqui.basic.StatusValidChange statusId="PMNT_RECEIVED" toStatusId="PMNT_REFUNDED" transitionName="Refunded"/>
            <moqui.basic.StatusValidChange statusId="PMNT_CONFIRMED" toStatusId="PMNT_REFUNDED" transitionName="Refunded"/>

            <moqui.basic.StatusValidChange statusId="PMNT_SENT" toStatusId="PMNT_CONFIRMED" transitionName="Confirmed"/>
            <moqui.basic.StatusValidChange statusId="PMNT_RECEIVED" toStatusId="PMNT_CONFIRMED" transitionName="Confirmed"/>
            <moqui.basic.StatusValidChange statusId="PMNT_SENT" toStatusId="PMNT_VOID" transitionName="Voided"/>
            <moqui.basic.StatusValidChange statusId="PMNT_RECEIVED" toStatusId="PMNT_VOID" transitionName="Voided"/>
            <moqui.basic.StatusValidChange statusId="PMNT_PROMISED" toStatusId="PMNT_VOID" transitionName="Voided"/>
            <moqui.basic.StatusValidChange statusId="PMNT_SENT" toStatusId="PMNT_PROMISED" transitionName="Not Paid"/>
            <moqui.basic.StatusValidChange statusId="PMNT_RECEIVED" toStatusId="PMNT_PROMISED" transitionName="Not Paid"/>
            <moqui.basic.StatusValidChange statusId="PMNT_CONFIRMED" toStatusId="PMNT_SENT" transitionName="Confirmed to Sent"/>
            <moqui.basic.StatusValidChange statusId="PMNT_CONFIRMED" toStatusId="PMNT_RECEIVED" transitionName="Confirmed to Received"/>
        </seed-data>
    </entity>
    <entity entity-name="PaymentFraudEvidence" package-name="mantle.account.payment">
        <description>
            Evidence of payment fraud with references to the Payment and possibly OrderHeader that represents the fraud.

            Other entities like ContactMech and PaymentMethod have a reference to this entity when they are gray- or
            black-listed based on this evidence.
        </description>
        <field name="paymentFraudEvidenceId" type="id" is-pk="true"/>
        <field name="fraudTypeEnumId" type="id"/>
        <field name="comments" type="text-medium"/>
        <field name="paymentId" type="id"/>
        <field name="orderId" type="id"/>
        <field name="partyId" type="id"/>
        <field name="visitId" type="id"/>
        <relationship type="one" title="FraudType" related-entity-name="moqui.basic.Enumeration">
            <key-map field-name="fraudTypeEnumId"/>
        </relationship>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment"/>
        <relationship type="one" related-entity-name="OrderHeader"/>
        <relationship type="one" related-entity-name="mantle.party.Party"/>
        <relationship type="one" related-entity-name="moqui.server.Visit"/>
    </entity>
    <entity entity-name="PaymentApplication" package-name="mantle.account.payment">
        <field name="paymentApplicationId" type="id" is-pk="true"/>
        <field name="paymentId" type="id"/>
        <field name="invoiceId" type="id"/>
        <field name="invoiceItemSeqId" type="id"/>
        <field name="billingAccountId" type="id"/>
        <field name="overrideGlAccountId" type="id"><description>If filled in, payment is applied directly against this
            GL account</description></field>
        <field name="toPaymentId" type="id"><description>To be used when a payment is based on or comes from another
            payment, like a payment that is a return of a mistaken or over-payment</description></field>
        <field name="taxAuthGeoId" type="id"/>
        <field name="amountApplied" type="currency-amount"/>
        <field name="appliedDate" type="date-time"/>
        <relationship type="one" related-entity-name="mantle.account.payment.Payment">
            <key-map field-name="paymentId"/>
        </relationship>
        <relationship type="one" related-entity-name="mantle.account.invoice.Invoice">
            <key-map field-name="invoiceId"/>
        </relationship>
        <relationship type="one-nofk" related-entity-name="mantle.account.invoice.InvoiceItem">
            <key-map field-name="invoiceId"/>
            <key-map field-name="invoiceItemSeqId"/>
        </relationship>
        <relationship type="one" related-entity-name="BillingAccount">
            <key-map field-name="billingAccountId"/>
        </relationship>
        <relationship type="one" title="To" related-entity-name="mantle.account.payment.Payment">
            <key-map field-name="toPaymentId"/>
        </relationship>
        <relationship type="one" title="TaxAuth" related-entity-name="Geo">
            <key-map field-name="taxAuthGeoId"/>
        </relationship>
        <relationship type="one" title="Override" related-entity-name="GlAccount">
            <key-map field-name="overrideGlAccountId"/>
        </relationship>
    </entity>
    <entity entity-name="PaymentBudgetAllocation" package-name="mantle.account.payment">
        <field name="paymentId" type="id" is-pk="true"/>
        <field name="budgetId" type="id" is-pk="true"/>
        <field name="budgetItemSeqId" type="id" is-pk="true"/>
        <field name="amount" type="currency-amount"/>
        <relationship type="one" related-entity-name="BudgetItem">
            <key-map field-name="budgetId"/>
            <key-map field-name="budgetItemSeqId"/>
        </relationship>
        <relationship type="one" related-entity-name="Payment"/>
    </entity>
</entities>
